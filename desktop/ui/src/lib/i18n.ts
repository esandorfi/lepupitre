import { ref } from "vue";

type Locale = "en" | "fr";

const STORAGE_KEY = "lepupitre_locale";

const messages: Record<Locale, Record<string, string>> = {
  en: {
    "nav.home": "Home",
    "nav.profiles": "Profiles",
    "nav.talk": "Talks",
    "nav.quest_active": "Quest",
    "nav.feedback_active": "Feedback",
    "nav.peer_review_active": "Peer review",
    "nav.boss_run": "Boss run",
    "nav.packs": "Packs",
    "nav.import": "Import",
    "nav.settings": "Settings",
    "theme.label": "Theme",
    "theme.orange": "Light",
    "theme.terminal": "Dark",
    "settings.transcription.title": "Transcription",
    "settings.transcription.subtitle": "Local whisper models and live mode.",
    "settings.transcription.scope": "Local only",
    "settings.transcription.model_label": "Model",
    "settings.transcription.model_tiny": "Tiny",
    "settings.transcription.model_base": "Base",
    "settings.transcription.model_bundled": "Bundled",
    "settings.transcription.model_download": "Download",
    "settings.transcription.model_note": "Tiny is bundled in release builds. Base is optional.",
    "settings.transcription.model_status_ready": "Ready",
    "settings.transcription.model_status_unverified": "Ready (unverified)",
    "settings.transcription.model_status_missing": "Not installed",
    "settings.transcription.model_status_missing_bundled": "Bundled (missing)",
    "settings.transcription.model_status_invalid": "Corrupted (re-download)",
    "settings.transcription.model_size": "Size",
    "settings.transcription.model_hash": "Checksum",
    "settings.transcription.model_source": "Source",
    "settings.transcription.open_source": "Open source",
    "settings.transcription.model_remove": "Remove",
    "settings.transcription.model_remove_confirm": "Remove this model from disk?",
    "settings.transcription.model_verify": "Verify",
    "settings.transcription.model_installed": "Installed",
    "settings.transcription.model_loading": "Loading models…",
    "settings.transcription.model_downloading": "Downloading…",
    "settings.transcription.model_verifying": "Verifying…",
    "settings.transcription.download_action": "Download",
    "settings.transcription.mode_label": "Mode",
    "settings.transcription.mode_auto": "Auto (benchmark tiny)",
    "settings.transcription.mode_live_final": "Live + Final",
    "settings.transcription.mode_final_only": "Final only",
    "settings.transcription.mode_note": "Tiny auto chooses based on device latency.",
    "settings.transcription.language_label": "Language",
    "settings.transcription.language_auto": "Auto",
    "settings.transcription.language_en": "English",
    "settings.transcription.language_fr": "French",
    "settings.transcription.language_note": "Auto tries to detect language.",
    "settings.transcription.download_base": "Download base model",
    "settings.transcription.download_note": "Downloads require explicit user action.",
    "home.title": "Home",
    "home.subtitle": "Daily quest loop, local-first.",
    "home.talk_title": "Talk",
    "home.talk_empty": "No active talk",
    "home.talk_action": "Manage talks",
    "home.boss_run_action": "Start boss run",
    "home.profile_title": "Profile",
    "home.profile_empty": "No active profile",
    "home.profile_active": "Active",
    "home.profile_action": "Manage profiles",
    "home.quest_title": "Daily quest",
    "home.quest_empty": "Create a profile and talk to load quests.",
    "home.quest_action": "Start quest",
    "home.quest_recommended": "Recommended",
    "home.quest_followup_title": "Quest follow-up",
    "home.quest_followup_empty": "No quests yet.",
    "home.quest_followup_continue": "Continue last quest",
    "home.quest_followup_replay": "Replay",
    "home.quest_followup_feedback": "Feedback",
    "home.prototype_title": "Prototype audio",
    "home.prototype_subtitle": "Quick record tied to the daily or free quest.",
    "home.prototype_action_daily": "Record daily quest",
    "home.prototype_action_free": "Free quest",
    "home.prototype_need_profile": "Create a profile first",
    "home.prototype_need_talk": "Create a talk first",
    "profiles.title": "Profiles",
    "profiles.subtitle": "Create a profile to start your local workspace.",
    "profiles.create_title": "Create profile",
    "profiles.create_placeholder": "Profile name",
    "profiles.create_action": "Create",
    "profiles.existing_title": "Existing profiles",
    "profiles.add_title": "Add profile",
    "profiles.name_required": "Name is required",
    "profiles.name_exists": "Profile name already exists",
    "profiles.confirm_delete": "Delete this profile and its local data?",
    "profiles.confirm_delete_action": "Delete",
    "profiles.cancel": "Cancel",
    "profiles.active": "Active",
    "profiles.switch": "Switch",
    "talk.title": "Talk setup",
    "talk.subtitle": "Define the talk you want to practice.",
    "talk.need_profile": "Create a profile first.",
    "talk.goto_profiles": "Go to Profiles",
    "talk.active_title": "Active talk",
    "talk.title_placeholder": "Talk title",
    "talk.audience_placeholder": "Audience (optional)",
    "talk.goal_placeholder": "Goal (optional)",
    "talk.duration_placeholder": "Target duration in minutes",
    "talk.save": "Save talk",
    "talk.back": "Back to Home",
    "talk.title_required": "Title is required",
    "quest.title": "Quest",
    "quest.code": "Code",
    "quest.daily": "daily",
    "quest.loading": "Loading quest...",
    "quest.response_placeholder": "Write your response",
    "quest.submit": "Submit text",
    "quest.back": "Back",
    "quest.audio_hint": "Record your response below.",
    "quest.request_feedback": "Ask for feedback",
    "quest.skip_transcription": "Skip transcription",
    "quest.transcript_optional": "Transcription is optional. You can keep the take without feedback.",
    "quest.empty": "No quest loaded yet.",
    "quest.response_required": "Response cannot be empty",
    "quest.status_feedback": "Feedback ready",
    "quest.status_transcribed": "Transcribed",
    "quest.status_recorded": "Recorded",
    "quest.status_submitted": "Submitted",
    "quest.status_not_started": "Not started",
    "quest.output_audio": "Audio",
    "quest.output_text": "Text",
    "talks.title": "Talks",
    "talks.subtitle": "Pick the talk you want to practice.",
    "talks.create": "New talk",
    "talks.empty": "No talk yet. Create the first one.",
    "talks.set_active": "Set active",
    "talks.active": "Active",
    "talks.loading": "Loading talks...",
    "talks.duration": "Target",
    "talks.minutes": "min",
    "talks.view_report": "Report",
    "talk_report.title": "Talk report",
    "talk_report.subtitle": "All quests and progress for this talk.",
    "talk_report.loading": "Loading report...",
    "talk_report.unknown": "Unknown talk",
    "talk_report.duration": "Target",
    "talk_report.minutes": "min",
    "talk_report.active": "Active",
    "talk_report.set_active": "Set active",
    "talk_report.back": "Back to talks",
    "talk_report.boss_run": "Boss run",
    "talk_report.builder": "Builder",
    "talk_report.packs": "Import feedback",
    "talk_report.export_title": "Export pack",
    "talk_report.total": "Quests",
    "talk_report.started": "Started",
    "talk_report.feedback": "Feedback",
    "talk_report.last_activity": "Last activity",
    "talk_report.quest_library": "Quest library",
    "talk_report.quest_label": "Quest",
    "talk_report.open_quest": "Open quest",
    "talk_report.view_feedback": "View feedback",
    "talk_report.no_quests": "No quests available.",
    "talk_report.timeline": "Timeline",
    "talk_report.timeline_empty": "No activity yet.",
    "talk_report.timeline_boss_run": "Boss run",
    "talk_report.timeline_started": "Started",
    "talk_report.timeline_recorded": "Recorded",
    "talk_report.timeline_transcribed": "Transcribed",
    "talk_report.timeline_feedback": "Feedback ready",
    "talk_report.timeline_peer_review": "Peer review",
    "talk_report.timeline_peer_review_status": "Review received",
    "talk_report.view_item": "View",
    "boss_run.title": "Boss run",
    "boss_run.subtitle": "Long-form recording and feedback loop (6-12 min).",
    "boss_run.no_talk": "Select an active talk to attach this run.",
    "boss_run.need_profile": "Create a profile to start a boss run.",
    "boss_run.setup_profile": "Go to Profiles",
    "boss_run.need_talk": "Create a talk before starting a boss run.",
    "boss_run.setup_talk": "Set up talk",
    "boss_run.audio_title": "Boss run recording",
    "boss_run.audio_subtitle": "Record a long-form take.",
    "boss_run.request_feedback": "Analyze run",
    "boss_run.view_report": "View report",
    "boss_run.transcript_optional": "Transcription is optional, but required for feedback.",
    "boss_run.latest_title": "Latest run",
    "boss_run.latest_label": "Boss run",
    "boss_run.latest_date": "Date",
    "boss_run.latest_status": "Status",
    "boss_run.latest_empty": "No boss run yet.",
    "boss_run.loading": "Loading boss run...",
    "boss_run.status_empty": "Not started",
    "boss_run.status_recorded": "Recorded",
    "boss_run.status_transcribed": "Transcribed",
    "boss_run.status_feedback": "Feedback ready",
    "boss_run.run_missing": "Record a run before analyzing.",
    "builder.title": "Talk builder",
    "builder.subtitle": "Shape your talk outline.",
    "builder.no_profile": "Create a profile to edit an outline.",
    "builder.no_talk": "Create a talk to start the outline.",
    "builder.setup_profile": "Go to Profiles",
    "builder.setup_talk": "Set up talk",
    "builder.outline_label": "Outline",
    "builder.save": "Save outline",
    "builder.saving": "Saving...",
    "builder.saved": "Outline saved",
    "builder.export": "Export markdown",
    "builder.export_ready": "Export ready",
    "builder.export_path": "Saved to",
    "builder.export_reveal": "Reveal file",
    "builder.loading": "Loading outline...",
    "packs.title": "Packs",
    "packs.subtitle": "Import peer feedback packs.",
    "packs.no_profile": "Create a profile to manage packs.",
    "packs.no_talk": "Create a talk to export runs.",
    "packs.setup_profile": "Go to Profiles",
    "packs.setup_talk": "Set up talk",
    "packs.run_list_title": "Boss runs",
    "packs.run_status_recorded": "Recorded",
    "packs.run_status_transcribed": "Transcribed",
    "packs.run_status_feedback": "Feedback ready",
    "packs.export": "Export pack",
    "packs.export_ready": "Export ready",
    "packs.export_path": "Saved to",
    "packs.export_reveal": "Reveal file",
    "packs.import_title": "Import peer review",
    "packs.import_drop_title": "Drop the pack zip here",
    "packs.import_drop_hint": "Drag a pack zip onto the window to import.",
    "packs.import_pick": "Or choose a file",
    "packs.import_path": "Selected file",
    "packs.import_checking": "Checking pack...",
    "packs.import_invalid": "Drop a valid pack zip first.",
    "packs.import_from": "From",
    "packs.import_from_unknown": "Unknown",
    "packs.import_contents": "Contents",
    "packs.import_pack_id": "Pack",
    "packs.import_placeholder": "Path to pack zip",
    "packs.import_no_path": "This file path is not available.",
    "packs.import_action": "Import",
    "packs.import_success": "Review imported",
    "packs.import_view_talk": "View imported talk",
    "feedback.title": "Feedback",
    "feedback.subtitle": "What to improve next.",
    "feedback.feedback_id": "Feedback id",
    "feedback.last_attempt": "Last attempt id",
    "feedback.back_parent": "Back to quest",
    "feedback.score": "Score",
    "feedback.loading": "Loading feedback...",
    "feedback.empty": "No feedback available yet.",
    "feedback.actions": "Top actions",
    "feedback.no_actions": "No priority action yet.",
    "feedback.metrics": "Metrics",
    "feedback.comments": "Comments",
    "feedback.metric_wpm": "Words per minute",
    "feedback.metric_fillers": "Fillers per minute",
    "feedback.metric_pause": "Pause count",
    "feedback.metric_sentence": "Avg sentence words",
    "feedback.metric_repeat": "Repeated terms",
    "feedback.context_label": "Context",
    "feedback.quest_code": "Quest",
    "feedback.run_label": "Boss run",
    "feedback.notes_title": "Your notes",
    "feedback.notes_placeholder": "Add your own notes or edits...",
    "feedback.notes_saving": "Saving notes...",
    "feedback.notes_saved": "Notes saved",
    "feedback.notes_error": "Could not save notes",
    "peer_review.title": "Peer review",
    "peer_review.subtitle": "Peer review summary.",
    "peer_review.loading": "Loading peer review...",
    "peer_review.back": "Back to talk",
    "peer_review.reviewer_unknown": "Anonymous reviewer",
    "peer_review.rubric": "Rubric",
    "peer_review.scores": "Scores",
    "peer_review.free_text": "Notes",
    "peer_review.timestamps": "Timestamps",
    "peer_review.empty": "No peer review data.",
    "security.title": "Security Probe (dev)",
    "security.subtitle": "Expect both tests to be blocked in production.",
    "security.test_network": "Test network",
    "security.test_blocked": "Test blocked path",
    "security.test_appdata": "Test appdata path",
    "security.network": "Network",
    "security.fs_blocked": "File system (blocked path)",
    "security.fs_appdata": "File system (appdata)",
    "audio.title": "Audio spike",
    "audio.subtitle": "Record a voice take locally.",
    "audio.pass_label": "Pass 0",
    "audio.start": "Start recording",
    "audio.stop": "Stop + Save",
    "audio.reveal": "Reveal file",
    "audio.transcribe": "Transcribe",
    "audio.status": "Status",
    "audio.status_idle": "Idle",
    "audio.status_requesting": "Requesting microphone",
    "audio.status_recording": "Recording",
    "audio.status_encoding": "Encoding",
    "audio.duration": "Duration",
    "audio.saved_to": "Saved to",
    "audio.transcription": "Transcription",
    "audio.stage_queued": "Queued",
    "audio.stage_analyze": "Analyzing audio",
    "audio.stage_serialize": "Finalizing transcript",
    "audio.stage_transcribe": "Transcribing",
    "audio.stage_final": "Final pass",
    "audio.stage_done": "Done",
    "audio.stage_processing": "Processing",
    "audio.transcript_title": "Transcript",
    "audio.export_txt": "Export .txt",
    "audio.export_json": "Export .json",
    "audio.export_srt": "Export .srt",
    "audio.export_vtt": "Export .vtt",
    "audio.exported_to": "Exported to",
    "audio.live_transcript": "Live transcript",
    "audio.profile_required": "Create a profile before recording.",
    "status.idle": "idle",
    "status.running": "running",
    "status.allowed": "allowed",
    "status.blocked": "blocked",
    "status.error": "error"
  },
  fr: {
    "nav.home": "Accueil",
    "nav.profiles": "Profils",
    "nav.talk": "Talks",
    "nav.quest_active": "Quête",
    "nav.feedback_active": "Feedback",
    "nav.peer_review_active": "Feedback pair",
    "nav.boss_run": "Boss run",
    "nav.packs": "Packs",
    "nav.import": "Importer",
    "nav.settings": "Réglages",
    "theme.label": "Thème",
    "theme.orange": "Clair",
    "theme.terminal": "Sombre",
    "settings.transcription.title": "Transcription",
    "settings.transcription.subtitle": "Modèles whisper locaux et mode live.",
    "settings.transcription.scope": "Local uniquement",
    "settings.transcription.model_label": "Modèle",
    "settings.transcription.model_tiny": "Tiny",
    "settings.transcription.model_base": "Base",
    "settings.transcription.model_bundled": "Inclus",
    "settings.transcription.model_download": "Téléchargement",
    "settings.transcription.model_note": "Tiny est inclus en release. Base est optionnel.",
    "settings.transcription.model_status_ready": "Prêt",
    "settings.transcription.model_status_unverified": "Prêt (non vérifié)",
    "settings.transcription.model_status_missing": "Non installé",
    "settings.transcription.model_status_missing_bundled": "Inclus (manquant)",
    "settings.transcription.model_status_invalid": "Corrompu (retélécharger)",
    "settings.transcription.model_size": "Taille",
    "settings.transcription.model_hash": "Checksum",
    "settings.transcription.model_source": "Source",
    "settings.transcription.open_source": "Ouvrir la source",
    "settings.transcription.model_remove": "Supprimer",
    "settings.transcription.model_remove_confirm": "Supprimer ce modèle du disque ?",
    "settings.transcription.model_verify": "Vérifier",
    "settings.transcription.model_installed": "Installé",
    "settings.transcription.model_loading": "Chargement des modèles…",
    "settings.transcription.model_downloading": "Téléchargement…",
    "settings.transcription.model_verifying": "Vérification…",
    "settings.transcription.download_action": "Télécharger",
    "settings.transcription.mode_label": "Mode",
    "settings.transcription.mode_auto": "Auto (benchmark tiny)",
    "settings.transcription.mode_live_final": "Live + final",
    "settings.transcription.mode_final_only": "Final seulement",
    "settings.transcription.mode_note": "Auto pour tiny selon la latence de la machine.",
    "settings.transcription.language_label": "Langue",
    "settings.transcription.language_auto": "Auto",
    "settings.transcription.language_en": "Anglais",
    "settings.transcription.language_fr": "Français",
    "settings.transcription.language_note": "Auto tente de détecter la langue.",
    "settings.transcription.download_base": "Télécharger le modèle base",
    "settings.transcription.download_note": "Le téléchargement nécessite une action explicite.",
    "home.title": "Accueil",
    "home.subtitle": "Daily quest loop,\nlocal-first.",
    "home.talk_title": "Talk",
    "home.talk_empty": "Aucun talk actif",
    "home.talk_action": "Gérer les talks",
    "home.boss_run_action": "Démarrer un boss run",
    "home.profile_title": "Profil",
    "home.profile_empty": "Aucun profil actif",
    "home.profile_active": "Actif",
    "home.profile_action": "Gérer les profils",
    "home.quest_title": "Quête du jour",
    "home.quest_empty": "Crée un profil et un talk pour charger les quêtes.",
    "home.quest_action": "Démarrer la quête",
    "home.quest_recommended": "Recommandé",
    "home.quest_followup_title": "Suivi des quêtes",
    "home.quest_followup_empty": "Pas encore de quête.",
    "home.quest_followup_continue": "Continuer la dernière quête",
    "home.quest_followup_replay": "Rejouer",
    "home.quest_followup_feedback": "Feedback",
    "home.prototype_title": "Prototype audio",
    "home.prototype_subtitle": "Prise rapide liée à la quête du jour ou libre.",
    "home.prototype_action_daily": "Enregistrer la quête du jour",
    "home.prototype_action_free": "Quête libre",
    "home.prototype_need_profile": "Crée d'abord un profil",
    "home.prototype_need_talk": "Crée d'abord un talk",
    "profiles.title": "Profils",
    "profiles.subtitle": "Crée un profil pour démarrer l'espace local.",
    "profiles.create_title": "Créer un profil",
    "profiles.create_placeholder": "Nom du profil",
    "profiles.create_action": "Créer",
    "profiles.existing_title": "Profils existants",
    "profiles.add_title": "Ajouter un profil",
    "profiles.name_required": "Le nom est requis",
    "profiles.name_exists": "Ce nom existe déjà",
    "profiles.confirm_delete": "Supprimer ce profil et ses données locales ?",
    "profiles.confirm_delete_action": "Supprimer",
    "profiles.cancel": "Annuler",
    "profiles.active": "Actif",
    "profiles.switch": "Basculer",
    "talk.title": "Préparer un talk",
    "talk.subtitle": "Préparer un talk, une conférence, un pitch.",
    "talk.need_profile": "Crée d'abord un profil.",
    "talk.goto_profiles": "Aller aux profils",
    "talk.active_title": "Talk actif",
    "talk.title_placeholder": "Titre du talk",
    "talk.audience_placeholder": "Audience (optionnel)",
    "talk.goal_placeholder": "Objectif (optionnel)",
    "talk.duration_placeholder": "Durée cible en minutes",
    "talk.save": "Enregistrer",
    "talk.back": "Retour à l'accueil",
    "talk.title_required": "Le titre est requis",
    "quest.title": "Quête",
    "quest.code": "Code",
    "quest.daily": "quotidien",
    "quest.loading": "Chargement de la quête...",
    "quest.response_placeholder": "Rédige ta réponse",
    "quest.submit": "Soumettre le texte",
    "quest.back": "Retour",
    "quest.audio_hint": "Enregistre ta réponse ci-dessous.",
    "quest.request_feedback": "Demander un feedback",
    "quest.skip_transcription": "Passer la transcription",
    "quest.transcript_optional": "La transcription est optionnelle. Tu peux garder la prise sans feedback.",
    "quest.empty": "Aucune quête chargée.",
    "quest.response_required": "La réponse ne peut pas être vide",
    "quest.status_feedback": "Feedback prêt",
    "quest.status_transcribed": "Transcrit",
    "quest.status_recorded": "Enregistré",
    "quest.status_submitted": "Soumis",
    "quest.status_not_started": "Pas démarré",
    "quest.output_audio": "Audio",
    "quest.output_text": "Texte",
    "talks.title": "Talks",
    "talks.subtitle": "Choisis le talk à travailler.",
    "talks.create": "Nouveau talk",
    "talks.empty": "Aucun talk. Crée le premier.",
    "talks.set_active": "Activer",
    "talks.active": "Actif",
    "talks.loading": "Chargement des talks...",
    "talks.duration": "Durée cible",
    "talks.minutes": "min",
    "talks.view_report": "Rapport",
    "talk_report.title": "Rapport du talk",
    "talk_report.subtitle": "Toutes les quêtes et la progression du talk.",
    "talk_report.loading": "Chargement du rapport...",
    "talk_report.unknown": "Talk inconnu",
    "talk_report.duration": "Durée cible",
    "talk_report.minutes": "min",
    "talk_report.active": "Actif",
    "talk_report.set_active": "Activer",
    "talk_report.back": "Retour aux talks",
    "talk_report.boss_run": "Boss run",
    "talk_report.builder": "Builder",
    "talk_report.packs": "Importer un feedback",
    "talk_report.export_title": "Exporter un pack",
    "talk_report.total": "Quêtes",
    "talk_report.started": "Démarrées",
    "talk_report.feedback": "Feedbacks",
    "talk_report.last_activity": "Dernière activité",
    "talk_report.quest_library": "Bibliothèque des quêtes",
    "talk_report.quest_label": "Quête",
    "talk_report.open_quest": "Ouvrir la quête",
    "talk_report.view_feedback": "Voir feedback",
    "talk_report.no_quests": "Aucune quête disponible.",
    "talk_report.timeline": "Timeline",
    "talk_report.timeline_empty": "Pas encore d'activité.",
    "talk_report.timeline_boss_run": "Boss run",
    "talk_report.timeline_started": "Démarré",
    "talk_report.timeline_recorded": "Enregistré",
    "talk_report.timeline_transcribed": "Transcrit",
    "talk_report.timeline_feedback": "Feedback prêt",
    "talk_report.timeline_peer_review": "Feedback pair",
    "talk_report.timeline_peer_review_status": "Revue reçue",
    "talk_report.view_item": "Voir",
    "boss_run.title": "Boss run",
    "boss_run.subtitle": "Enregistrement long + feedback (6-12 min).",
    "boss_run.no_talk": "Sélectionne un talk actif pour rattacher ce run.",
    "boss_run.need_profile": "Crée un profil pour lancer un boss run.",
    "boss_run.setup_profile": "Aller aux profils",
    "boss_run.need_talk": "Crée un talk avant de lancer un boss run.",
    "boss_run.setup_talk": "Créer un talk",
    "boss_run.audio_title": "Enregistrement boss run",
    "boss_run.audio_subtitle": "Enregistre une prise longue.",
    "boss_run.request_feedback": "Analyser le run",
    "boss_run.view_report": "Voir le rapport",
    "boss_run.transcript_optional": "La transcription est optionnelle, mais requise pour le feedback.",
    "boss_run.latest_title": "Dernier run",
    "boss_run.latest_label": "Boss run",
    "boss_run.latest_date": "Date",
    "boss_run.latest_status": "Statut",
    "boss_run.latest_empty": "Pas encore de boss run.",
    "boss_run.loading": "Chargement du boss run...",
    "boss_run.status_empty": "Pas démarré",
    "boss_run.status_recorded": "Enregistré",
    "boss_run.status_transcribed": "Transcrit",
    "boss_run.status_feedback": "Feedback prêt",
    "boss_run.run_missing": "Enregistre un run avant d'analyser.",
    "builder.title": "Talk builder",
    "builder.subtitle": "Structure le plan du talk.",
    "builder.no_profile": "Crée un profil pour éditer un plan.",
    "builder.no_talk": "Crée un talk pour démarrer le plan.",
    "builder.setup_profile": "Aller aux profils",
    "builder.setup_talk": "Créer un talk",
    "builder.outline_label": "Plan",
    "builder.save": "Enregistrer le plan",
    "builder.saving": "Enregistrement...",
    "builder.saved": "Plan enregistré",
    "builder.export": "Exporter en markdown",
    "builder.export_ready": "Export prêt",
    "builder.export_path": "Enregistré dans",
    "builder.export_reveal": "Afficher le fichier",
    "builder.loading": "Chargement du plan...",
    "packs.title": "Packs",
    "packs.subtitle": "Importer un feedback pair.",
    "packs.no_profile": "Crée un profil pour gérer les packs.",
    "packs.no_talk": "Crée un talk pour exporter des runs.",
    "packs.setup_profile": "Aller aux profils",
    "packs.setup_talk": "Créer un talk",
    "packs.run_list_title": "Boss runs",
    "packs.run_status_recorded": "Enregistré",
    "packs.run_status_transcribed": "Transcrit",
    "packs.run_status_feedback": "Feedback prêt",
    "packs.export": "Exporter le pack",
    "packs.export_ready": "Export prêt",
    "packs.export_path": "Enregistré dans",
    "packs.export_reveal": "Afficher le fichier",
    "packs.import_title": "Importer un feedback pair",
    "packs.import_drop_title": "Dépose le pack zip ici",
    "packs.import_drop_hint": "Glisse un pack zip sur la fenêtre pour importer.",
    "packs.import_pick": "Ou choisir un fichier",
    "packs.import_path": "Fichier sélectionné",
    "packs.import_checking": "Vérification du pack...",
    "packs.import_invalid": "Dépose d'abord un pack zip valide.",
    "packs.import_from": "De",
    "packs.import_from_unknown": "Inconnu",
    "packs.import_contents": "Contenu",
    "packs.import_pack_id": "Pack",
    "packs.import_placeholder": "Chemin du pack zip",
    "packs.import_no_path": "Ce chemin de fichier n'est pas disponible.",
    "packs.import_action": "Importer",
    "packs.import_success": "Feedback importé",
    "packs.import_view_talk": "Voir le talk importé",
    "feedback.title": "Feedback",
    "feedback.subtitle": "Prochaines améliorations.",
    "feedback.feedback_id": "ID feedback",
    "feedback.last_attempt": "Dernière tentative",
    "feedback.back_parent": "Retour à la quête",
    "feedback.score": "Score",
    "feedback.loading": "Chargement du feedback...",
    "feedback.empty": "Aucun feedback disponible.",
    "feedback.actions": "Priorités",
    "feedback.no_actions": "Aucune priorité pour l'instant.",
    "feedback.metrics": "Métriques",
    "feedback.comments": "Commentaires",
    "feedback.metric_wpm": "Mots par minute",
    "feedback.metric_fillers": "Tics par minute",
    "feedback.metric_pause": "Pauses",
    "feedback.metric_sentence": "Mots par phrase",
    "feedback.metric_repeat": "Mots répétés",
    "feedback.context_label": "Contexte",
    "feedback.quest_code": "Quête",
    "feedback.run_label": "Boss run",
    "feedback.notes_title": "Tes notes",
    "feedback.notes_placeholder": "Ajoute tes notes ou corrections...",
    "feedback.notes_saving": "Enregistrement...",
    "feedback.notes_saved": "Notes enregistrées",
    "feedback.notes_error": "Impossible d'enregistrer",
    "peer_review.title": "Feedback pair",
    "peer_review.subtitle": "Synthèse du feedback pair.",
    "peer_review.loading": "Chargement du feedback pair...",
    "peer_review.back": "Retour au talk",
    "peer_review.reviewer_unknown": "Revieweur anonyme",
    "peer_review.rubric": "Rubrique",
    "peer_review.scores": "Scores",
    "peer_review.free_text": "Notes",
    "peer_review.timestamps": "Repères",
    "peer_review.empty": "Aucune donnée de feedback pair.",
    "security.title": "Sonde sécurité (dev)",
    "security.subtitle": "Les deux tests doivent être bloqués en production.",
    "security.test_network": "Tester le réseau",
    "security.test_blocked": "Tester un chemin interdit",
    "security.test_appdata": "Tester appdata",
    "security.network": "Réseau",
    "security.fs_blocked": "Système de fichiers (interdit)",
    "security.fs_appdata": "Système de fichiers (appdata)",
    "audio.title": "Prototype audio",
    "audio.subtitle": "Enregistre une prise de voix en local.",
    "audio.pass_label": "Passe 0",
    "audio.start": "Démarrer",
    "audio.stop": "Arrêter + sauver",
    "audio.reveal": "Afficher le fichier",
    "audio.transcribe": "Transcrire",
    "audio.status": "Statut",
    "audio.status_idle": "Inactif",
    "audio.status_requesting": "Demande micro",
    "audio.status_recording": "Enregistrement",
    "audio.status_encoding": "Encodage",
    "audio.duration": "Durée",
    "audio.saved_to": "Enregistré dans",
    "audio.transcription": "Transcription",
    "audio.stage_queued": "En attente",
    "audio.stage_analyze": "Analyse audio",
    "audio.stage_serialize": "Finalisation",
    "audio.stage_transcribe": "Transcription",
    "audio.stage_final": "Passe finale",
    "audio.stage_done": "Terminé",
    "audio.stage_processing": "Traitement",
    "audio.transcript_title": "Transcript",
    "audio.export_txt": "Exporter en .txt",
    "audio.export_json": "Exporter en .json",
    "audio.export_srt": "Exporter en .srt",
    "audio.export_vtt": "Exporter en .vtt",
    "audio.exported_to": "Exporté dans",
    "audio.live_transcript": "Transcription live",
    "audio.profile_required": "Crée un profil avant d'enregistrer.",
    "status.idle": "inactif",
    "status.running": "en cours",
    "status.allowed": "autorisé",
    "status.blocked": "bloqué",
    "status.error": "erreur"
  }
};

function loadLocale(): Locale {
  try {
    const stored = localStorage.getItem(STORAGE_KEY);
    if (stored === "en" || stored === "fr") {
      return stored;
    }
  } catch {
    return "en";
  }
  return "en";
}

const locale = ref<Locale>(loadLocale());

function setLocale(next: Locale) {
  locale.value = next;
  try {
    localStorage.setItem(STORAGE_KEY, next);
  } catch {
    // ignore storage errors
  }
}

function t(key: string) {
  return messages[locale.value][key] ?? key;
}

export function useI18n() {
  return { locale, setLocale, t };
}
